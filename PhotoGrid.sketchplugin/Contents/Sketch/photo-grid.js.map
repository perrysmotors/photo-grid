{"version":3,"sources":["webpack://exports/webpack/bootstrap","webpack://exports/./src/photo-grid.js","webpack://exports/external \"sketch/dom\"","webpack://exports/external \"sketch/settings\"","webpack://exports/external \"sketch/ui\""],"names":["UI","require","DOM","Settings","aspectRatios","options","initOptions","form","defaults","isRowLayout","padding","hasWidthLimit","maxWidth","option","value","eval","settingForKey","undefined","setSettingForKey","onRandomizeAspectRatios","context","document","getSelectedDocument","selection","selectedLayers","length","message","bounds","getBoundingBox","layers","groups","findGroups","forEach","group","randomizeAspectRatios","onFit","width","y","fitLayersInRows","sketchObject","absoluteRect","frame","height","x","fitLayersInColumns","onSettings","alert","createDialog","response","runModal","spacingTextFieldInput","spacingTextField","stringValue","spacingValue","parseInt","isNaN","rowsRadioButton","state","NSOnState","hasWidthLimitCheckbox","maxWidthTextFieldInput","maxWidthTextField","maxWidthValue","orderedLayers","sort","a","b","layer","setConstrainProportions","ratio","randomAspectRatio","delta","getDelta","Math","round","floor","random","min","max","lastLayer","median","map","widths","totalWidth","reduce","total","current","totalPadding","scale","heights","totalHeight","deltaX","deltaY","remainingLayers","Set","range","largestGroup","findLayersInGroup","delete","push","size","groupA","groupB","referenceLayer","found","rowCentre","getLayerCentre","lower","upper","centre","values","half","lefts","rights","tops","bottoms","viewWidth","viewHeight","dialog","NSAlert","alloc","init","setMessageText","addButtonWithTitle","view","NSView","initWithFrame","NSMakeRect","setAccessoryView","infoLabel","createTextField","spacingLabel","layoutLabel","maxWidthLabel","NSTextField","createRadioButton","columnsRadioButton","createCheckbox","setStringValue","String","setState","setEnabled","setCOSJSTargetFunction","sender","radioTargetFunction","addSubview","textField","setSelectable","setEditable","setBezeled","setDrawsBackground","title","checkbox","NSButton","setButtonType","NSSwitchButton","setBezelStyle","setTitle","radioButton","NSRadioButton"],"mappings":"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","file":"photo-grid.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/photo-grid.js\");\n","const UI = require('sketch/ui'),\n      DOM = require('sketch/dom'),\n      Settings = require('sketch/settings');\n\nconst aspectRatios = [1, 10/8, 4/3, 7/5, 3/2, 16/9, 2/3, 5/7, 3/4, 8/10];\n\nvar options = initOptions();\nvar form = {};\n\nfunction initOptions() {\n  const defaults = {\n    isRowLayout: true,\n    padding: 16,\n    hasWidthLimit: false,\n    maxWidth: 1200\n  };\n  for (let option in defaults) {\n    let value = eval(Settings.settingForKey(option));\n    if (value === undefined) {\n      Settings.setSettingForKey(option, defaults[option]);\n    } else {\n      defaults[option] = value;\n    }\n  }\n  return defaults\n}\n\nexport function onRandomizeAspectRatios(context) {\n  var document = DOM.getSelectedDocument(),\n      selection = document.selectedLayers;\n\n  if (selection.length === 0) {\n    UI.message('Select one or more layers');\n  } else {\n    let bounds = getBoundingBox(selection.layers);\n    let groups = findGroups(selection.layers);\n\n    groups.forEach(group => {\n      randomizeAspectRatios(group, bounds);\n    });\n  }\n}\n\nexport function onFit(context) {\n  var document = DOM.getSelectedDocument(),\n      selection = document.selectedLayers;\n\n  if (selection.length === 0) {\n    UI.message('Select one or more layers');\n  } else {\n    let bounds = getBoundingBox(selection.layers);\n    let groups = findGroups(selection.layers);\n\n    if (options.isRowLayout) {\n      if (options.hasWidthLimit) {\n        bounds.width = options.maxWidth;\n      }\n\n      let y = bounds.y;\n      groups.forEach(group => {\n        fitLayersInRows(group, bounds, y);\n        y = group[0].sketchObject.absoluteRect().y() + group[0].frame.height + options.padding;\n      });\n\n    } else {\n\n      let x = bounds.x;\n      groups.forEach(group => {\n        fitLayersInColumns(group, bounds, x);\n        x = group[0].sketchObject.absoluteRect().x() + group[0].frame.width + options.padding;\n      });\n\n    }\n  }\n}\n\nexport function onSettings(context) {\n\n  var alert = createDialog();\n\n  var response = alert.runModal();\n\n  if (response == \"1000\") {\n    // This code only runs when the user clicks 'OK';\n\n    // Get Spacing\n    let spacingTextFieldInput = form.spacingTextField.stringValue();\n    let spacingValue = parseInt(spacingTextFieldInput);\n\n    if (isNaN(spacingValue) || spacingTextFieldInput === '') {\n      UI.message('⚠️ The spacing was not changed. Try entering a number.');\n    } else if (spacingValue < 0 || spacingValue > 1000) {\n      UI.message('⚠️ Enter a spacing value between 0 and 1000');\n    } else {\n      options.padding = spacingValue;\n      Settings.setSettingForKey('padding', spacingValue);\n    }\n\n    // Get Layout\n    options.isRowLayout = (form.rowsRadioButton.state() === NSOnState);\n    Settings.setSettingForKey('isRowLayout', options.isRowLayout);\n\n    // Get max width setting\n    options.hasWidthLimit = (form.hasWidthLimitCheckbox.state() === NSOnState);\n    Settings.setSettingForKey('hasWidthLimit', options.hasWidthLimit);\n\n    // Get width value\n    let maxWidthTextFieldInput = form.maxWidthTextField.stringValue();\n    let maxWidthValue = parseInt(maxWidthTextFieldInput);\n\n    if (isNaN(maxWidthValue) || maxWidthTextFieldInput === '') {\n      UI.message('⚠️ The maximum width was not changed. Try entering a number.');\n    } else if (maxWidthValue < 10 || maxWidthValue > 10000) {\n      UI.message('⚠️ Enter a maximum width between 10 and 10,000');\n    } else {\n      options.maxWidth = maxWidthValue;\n      Settings.setSettingForKey('maxWidth', maxWidthValue);\n    }\n\n  }\n\n}\n\nfunction randomizeAspectRatios(layers, bounds) {\n  let orderedLayers;\n\n  let x = bounds.x,\n      y = bounds.y;\n\n  if (options.isRowLayout) {\n    orderedLayers = layers.sort((a, b) => a.sketchObject.absoluteRect().x() - b.sketchObject.absoluteRect().x());\n    y = orderedLayers[0].sketchObject.absoluteRect().y();\n  } else {\n    orderedLayers = layers.sort((a, b) => a.sketchObject.absoluteRect().y() - b.sketchObject.absoluteRect().y());\n    x = orderedLayers[0].sketchObject.absoluteRect().x();\n  }\n\n  orderedLayers.forEach(layer => {\n\n    layer.sketchObject.setConstrainProportions(0);\n\n    let ratio = randomAspectRatio();\n    let delta = getDelta(layer, x, y);\n    let frame = layer.frame;\n\n    frame.x += delta.x;\n    frame.y += delta.y;\n\n    if (options.isRowLayout) {\n      frame.width = Math.round(frame.height * ratio);\n      x += frame.width + options.padding;\n    } else {\n      frame.height = Math.round(frame.width / ratio);\n      y += frame.height + options.padding;\n    }\n\n    layer.frame = frame;\n\n  });\n\n}\n\nfunction randomAspectRatio() {\n  return aspectRatios[Math.floor(Math.random() * aspectRatios.length)]\n}\n\nfunction fitLayersInRows(layers, bounds, y) {\n  let min = bounds.x;\n  let max = bounds.x + bounds.width;\n\n  let orderedLayers = layers.sort((a, b) => a.sketchObject.absoluteRect().x() - b.sketchObject.absoluteRect().x());\n  let lastLayer = orderedLayers[orderedLayers.length - 1];\n\n  let height = Math.round(median(layers.map(layer => layer.frame.height)));\n  let widths = layers.map(layer => layer.frame.width * height / layer.frame.height);\n  let totalWidth = widths.reduce((total, current) => total + current);\n\n  let totalPadding = (layers.length - 1) * options.padding;\n  let scale = (max - min) / (totalWidth + totalPadding);\n\n  let x = min;\n\n  orderedLayers.forEach(layer => {\n\n    layer.sketchObject.setConstrainProportions(0);\n\n    let delta = getDelta(layer, x, y);\n    let frame = layer.frame;\n\n    frame.x += delta.x;\n    frame.y += delta.y;\n\n    frame.width = Math.round(frame.width * height / frame.height * scale);\n    frame.height = Math.round(height * scale);\n    x += frame.width + options.padding;\n\n    layer.frame = frame;\n\n  });\n\n  let frame = lastLayer.frame;\n  frame.width = max - lastLayer.sketchObject.absoluteRect().x();\n  lastLayer.frame = frame;\n\n}\n\nfunction fitLayersInColumns(layers, bounds, x) {\n  let min = bounds.y;\n  let max = bounds.y + bounds.height;\n\n  let orderedLayers = layers.sort((a, b) => a.sketchObject.absoluteRect().y() - b.sketchObject.absoluteRect().y());\n  let lastLayer = orderedLayers[orderedLayers.length - 1];\n\n  let width = Math.round(median(layers.map(layer => layer.frame.width)));\n  let heights = layers.map(layer => layer.frame.height * width / layer.frame.width);\n  let totalHeight = heights.reduce((total, current) => total + current);\n\n  let totalPadding = (layers.length - 1) * options.padding;\n  let scale = (max - min) / (totalHeight + totalPadding);\n\n  let y = min;\n\n  orderedLayers.forEach(layer => {\n\n    layer.sketchObject.setConstrainProportions(0);\n\n    let delta = getDelta(layer, x, y);\n    let frame = layer.frame;\n\n    frame.x += delta.x;\n    frame.y += delta.y;\n\n    frame.height = Math.round(frame.height * width / frame.width * scale);\n    frame.width = Math.round(width * scale);\n    y += frame.height + options.padding;\n\n    layer.frame = frame;\n\n  });\n\n  let frame = lastLayer.frame;\n  frame.height = max - lastLayer.sketchObject.absoluteRect().y();\n  lastLayer.frame = frame;\n\n}\n\nfunction getDelta(layer, x, y) {\n  let absoluteRect = layer.sketchObject.absoluteRect();\n  let deltaX = x - absoluteRect.x();\n  let deltaY = y - absoluteRect.y();\n  return {x: deltaX, y: deltaY};\n}\n\nfunction findGroups(layers) {\n  let groups = [];\n  let remainingLayers = new Set(layers);\n\n  let range;\n  if (options.isRowLayout) {\n    range = Math.round(median(layers.map(layer => layer.frame.height)));\n  } else {\n    range = Math.round(median(layers.map(layer => layer.frame.width)));\n  }\n\n  while (remainingLayers.size > 0) {\n    let largestGroup = [];\n    remainingLayers.forEach(layer => {\n      let group = findLayersInGroup(remainingLayers, layer, range);\n      if (group.length > largestGroup.length) {\n        largestGroup = group;\n      }\n    });\n\n    largestGroup.forEach(layer => {\n      remainingLayers.delete(layer);\n    });\n\n    groups.push(largestGroup);\n  }\n\n  if (options.isRowLayout) {\n    return groups.sort((groupA, groupB) => groupA[0].sketchObject.absoluteRect().y() - groupB[0].sketchObject.absoluteRect().y());\n  } else {\n    return groups.sort((groupA, groupB) => groupA[0].sketchObject.absoluteRect().x() - groupB[0].sketchObject.absoluteRect().x());\n  }\n\n}\n\nfunction findLayersInGroup(layers, referenceLayer, range) {\n\n  let found = [];\n  let rowCentre = getLayerCentre(referenceLayer);\n\n  if (options.isRowLayout) {\n\n    let lower = rowCentre.y - range / 2;\n    let upper = rowCentre.y + range / 2;\n\n    layers.forEach(layer => {\n      let centre = getLayerCentre(layer);\n      if (centre.y > lower && centre.y < upper) {\n        found.push(layer);\n      }\n    });\n\n  } else {\n\n    let lower = rowCentre.x - range / 2;\n    let upper = rowCentre.x + range / 2;\n\n    layers.forEach(layer => {\n      let centre = getLayerCentre(layer);\n      if (centre.x > lower && centre.x < upper) {\n        found.push(layer);\n      }\n    });\n\n  }\n\n  return found;\n}\n\nfunction median(values) {\n  values.sort((a, b) => a - b);\n  let half = Math.floor(values.length/2);\n\n  if (values.length % 2) {\n    return values[half];\n  } else {\n    return (values[half-1] + values[half]) / 2.0;\n  }\n}\n\nfunction getBoundingBox(layers) {\n  let lefts = layers.map(layer => layer.sketchObject.absoluteRect().x()).sort((a, b) => a - b);\n  let rights = layers.map(layer => layer.sketchObject.absoluteRect().x() + layer.frame.width).sort((a, b) => a - b);\n  let tops = layers.map(layer => layer.sketchObject.absoluteRect().y()).sort((a, b) => a - b);\n  let bottoms = layers.map(layer => layer.sketchObject.absoluteRect().y() + layer.frame.height).sort((a, b) => a - b);\n  return {\n    x: lefts[0],\n    y: tops[0],\n    width: rights[layers.length - 1] - lefts[0],\n    height: bottoms[layers.length - 1] - tops[0]\n  }\n}\n\nfunction getLayerCentre(layer) {\n  return {\n    x: layer.sketchObject.absoluteRect().x() + layer.frame.width / 2,\n    y: layer.sketchObject.absoluteRect().y() + layer.frame.height / 2\n  };\n}\n\n// function numberLayers(layers, prefix) {\n//   let i = 1;\n//   layers.forEach(layer => {\n//     layer.name += `${prefix}-${i++}`\n//   });\n// }\n\nfunction createDialog() {\n\n  var viewWidth = 360;\n  var viewHeight = 250;\n\n  // Setup the window\n  var dialog = NSAlert.alloc().init();\n  dialog.setMessageText('Photo Grid Settings')\n  dialog.addButtonWithTitle('Ok');\n  dialog.addButtonWithTitle('Cancel');\n\n  // Create the main view\n  var view = NSView.alloc().initWithFrame(NSMakeRect(0, 0, viewWidth, viewHeight));\n  dialog.setAccessoryView(view);\n\n  // --------------------------------------------------------------------------\n\n  // Create labels\n  var infoLabel = createTextField('Choose row or column layout and set the layer spacing. Photo Grid will try to keep layers in existing rows or columns.' , NSMakeRect(0, viewHeight - 40, viewWidth - 10, 40));\n  var spacingLabel = createTextField('Spacing:', NSMakeRect(0, viewHeight - 70, 200, 20));\n  var layoutLabel = createTextField('Layout:', NSMakeRect(0, viewHeight - 135, 200, 20));\n  var maxWidthLabel = createTextField('Scale and Fit Rows to Fixed Width:', NSMakeRect(0, viewHeight - 200, viewWidth -10, 20));\n\n  // Create textfields\n  form.spacingTextField = NSTextField.alloc().initWithFrame(NSMakeRect(0, viewHeight - 95, 70, 20));\n  form.maxWidthTextField = NSTextField.alloc().initWithFrame(NSMakeRect(90, viewHeight - 225, 70, 20));\n\n  // Create radiobuttons\n  form.rowsRadioButton = createRadioButton('Rows →', NSMakeRect(0, viewHeight - 160, 90, 20));\n  form.columnsRadioButton = createRadioButton('Columns ↓', NSMakeRect(80, viewHeight - 160, 90, 20));\n\n  // Create checkbox\n  form.hasWidthLimitCheckbox = createCheckbox('On', NSMakeRect(0, viewHeight - 225, 90, 20));\n\n  // --------------------------------------------------------------------------\n\n  // Set initial input values and enabled states\n  form.spacingTextField.setStringValue(String(options.padding));\n  form.maxWidthTextField.setStringValue(String(options.maxWidth));\n\n  if (options.hasWidthLimit) {\n    form.hasWidthLimitCheckbox.setState(NSOnState);\n  } else {\n    form.maxWidthTextField.setEnabled(false);\n  }\n\n  if (options.isRowLayout) {\n    form.rowsRadioButton.setState(NSOnState);\n  } else {\n    form.columnsRadioButton.setState(NSOnState);\n    form.hasWidthLimitCheckbox.setEnabled(false);\n    form.maxWidthTextField.setEnabled(false);\n  }\n\n  // --------------------------------------------------------------------------\n\n  // Handle Enable / Disable Events\n  form.hasWidthLimitCheckbox.setCOSJSTargetFunction((sender) => {\n    form.maxWidthTextField.setEnabled(sender.state() === NSOnState);\n  });\n\n  let radioTargetFunction = (sender) => {\n    let isRowLayout = (sender === form.rowsRadioButton);\n    let hasWidthLimit = (form.hasWidthLimitCheckbox.state() === NSOnState);\n    if (isRowLayout) {\n      form.hasWidthLimitCheckbox.setEnabled(true);\n      form.maxWidthTextField.setEnabled(hasWidthLimit);\n    } else {\n      form.hasWidthLimitCheckbox.setEnabled(false);\n      form.maxWidthTextField.setEnabled(false);\n    }\n  };\n\n  form.rowsRadioButton.setCOSJSTargetFunction(sender => radioTargetFunction(sender));\n  form.columnsRadioButton.setCOSJSTargetFunction(sender => radioTargetFunction(sender));\n\n  // --------------------------------------------------------------------------\n\n  // Add inputs to view\n  view.addSubview(infoLabel);\n  view.addSubview(spacingLabel);\n  view.addSubview(layoutLabel);\n  view.addSubview(maxWidthLabel);\n  view.addSubview(form.spacingTextField);\n  view.addSubview(form.maxWidthTextField);\n  view.addSubview(form.rowsRadioButton);\n  view.addSubview(form.columnsRadioButton);\n  view.addSubview(form.hasWidthLimitCheckbox);\n\n  // --------------------------------------------------------------------------\n\n  // Show the dialog window\n  return dialog;\n}\n\nfunction createTextField(stringValue, frame) {\n  let textField = NSTextField.alloc().initWithFrame(frame);\n  textField.setStringValue(stringValue);\n  textField.setSelectable(false);\n  textField.setEditable(false);\n  textField.setBezeled(false);\n  textField.setDrawsBackground(false);\n  return textField;\n}\n\nfunction createCheckbox(title, frame) {\n  let checkbox = NSButton.alloc().initWithFrame(frame);\n  checkbox.setButtonType(NSSwitchButton);\n  checkbox.setBezelStyle(0);\n  checkbox.setTitle(title);\n\n  return checkbox;\n}\n\nfunction createRadioButton(title, frame) {\n  let radioButton = NSButton.alloc().initWithFrame(frame);\n  radioButton.setButtonType(NSRadioButton);\n  radioButton.setTitle(title);\n\n  return radioButton;\n}\n","module.exports = require(\"sketch/dom\");","module.exports = require(\"sketch/settings\");","module.exports = require(\"sketch/ui\");"],"sourceRoot":""}